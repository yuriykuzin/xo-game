{"version":3,"sources":["webpack:///webpack/bootstrap a609236f30d6db3862d7","webpack:///./xo-game-main.js","webpack:///./~/shake.js/shake.js","webpack:///./xo-game-engine.js","webpack:///./~/classlist-polyfill/src/index.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oE;AACA;AACA;;AAEA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,sBAAqB,wBAAwB;AAC7C;AACA;AACA,wBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,wBAAwB;AAChE,eAAc,gCAAgC;AAC9C,sBAAqB,wBAAwB;AAC7C;AACA;AACA,wBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,I;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;AACA;AACA;AACA;AACA,sBAAqB,kBAAkB;AACvC;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA,cAAa;AACb,YAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAoC,KAAK;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,sDAAqD,oDAAoD;AACzG;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA,sBAAqB,6BAA6B;AAClD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,sBAAqB,kBAAkB;AACvC;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA,EAAC;;;;;;;AC1bD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,UAAS;AACT,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA,EAAC;;AAED;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb,UAAS;AACT;AACA;AACA,UAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,EAAC;;;;;;;AChID;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oEAAmE;AACnE;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB,OAAO;AAC5B,wBAAuB,OAAO;AAC9B;AACA,6DAA4D;AAC5D,iEAAgE;AAChE;AACA,wDAAuD;AACvD,kCAAiC;;AAEjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0CAAyC;AACzC;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,uBAAsB;AACtB,gCAA+B;AAC/B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mBAAkB;AAClB;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA,4BAA2B;AAC3B,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACtMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,SAAS;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO,aAAa;AACpB;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;;AAEA,MAAK;;AAEL,MAAK;AACL;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,wBAAuB,SAAS;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAW;AACX;AACA;AACA;;AAEA;;AAEA;AACA,MAAK;AACL;AACA","file":"xo-game-bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap a609236f30d6db3862d7\n **/","! function() {\n\n  'use strict';\n\n  var Shake = require('shake.js');\n  var XoGameEngine = require('./xo-game-engine');\n  var myGameEngine = new XoGameEngine();\n  require('classlist-polyfill');\n\n  var gameSettings = {\n    isHumanX: false,\n    isHumanO: true,\n    isGameActive: false,\n    isNextTurnByX: true,\n    whoGoesFirst: 'x',\n    sizeX: 3,\n    sizeY: 3,\n    winCondition: 3\n  };\n\n  //  fast access to some DOM elements:\n  var backFieldElement;\n  var fieldElement;\n  var boardGameElement;\n  var boardElement;\n  var optionsBtnElement;\n  var optionsFrameElement;\n  var myCellStyle;\n  \n  var isContinueEnabled = true;\n  var isJustLoaded = true;\n  var isProcessing = false;\n\n  window.onload = function() {\n    myCellStyle = document.createElement('style');\n    myCellStyle.id = 's_myCellStyle';\n    document.head.appendChild(myCellStyle);\n    myCellStyle = document.getElementById('s_myCellStyle');\n    boardGameElement = document.querySelector('.board__game');\n    fieldElement = document.querySelector('.field');\n    boardElement = document.querySelector('.board');\n    optionsFrameElement = document.querySelector('.options-frame');    \n    backFieldElement = document.querySelector('.field__background');\n    optionsBtnElement = document.querySelector('.options-button');\n    \n    setTimeout(function() {\n      boardGameElement.classList.remove('boardgame__start-animation');\n    }, 1200);\n  \n    fieldElement.addEventListener('click', clickHandler, false);\n    optionsFrameElement.querySelector('.options-form').addEventListener('click', submitOptionsHandler, false);\n    optionsFrameElement.querySelector('.options-form').addEventListener('change', checkIfSizeWinChange, false);\n    optionsBtnElement.addEventListener('click', showOptions, false);\n    fieldElement.addEventListener('click', clickHandler, false);\n\n    var myShakeEvent = new Shake({\n      threshold: 3,\n      timeout: 1000\n    });\n    myShakeEvent.start();\n    window.addEventListener('shake', shakeEventDidOccur, false);\n    \n    initGame();\n  };\n  \n  function initGame() {\n    var fragment = document.createDocumentFragment();\n    var isSettingsLoaded = false;\n    var newElement;\n    var newRow;\n    var loadedTurns;\n    var size;\n    \n    if (isJustLoaded && localStorage.length >= 8) {\n      isSettingsLoaded = loadSettingsFromLocal();\n    }\n\n    if (checkIfTicTacToe()) {\n\n      // TicTacToe game (original version of appearance):\n      myCellStyle.textContent = '';\n      for (var i = 0; i < gameSettings.sizeY; i++) {\n        newRow = document.createElement('div');\n        newRow.className = 'field__row';\n        for (var j = 0; j < gameSettings.sizeX; j++) {\n          newElement = document.createElement('div');\n          newElement.className = 'cell empty';\n          newElement.id = 'cell' + j + '_' + i;\n          newRow.appendChild(newElement);\n        }\n        fragment.appendChild(newRow);\n      }\n    }\n    else {\n\n      /*\n      *   Custom field of any size and win condition. \n      *   Render it with dotted borders and custom size:\n      */\n      size = 90 / (Math.max(gameSettings.sizeX, gameSettings.sizeY)) \n        - 140 / Math.min(document.body.clientWidth, document.body.clientHeight);\n      myCellStyle.textContent = '.cell {width: ' + size + 'vmin; height: ' + size +\n        'vmin; font-size: ' + (size) + 'vmin;}';\n      for (var i = 0; i < gameSettings.sizeY; i++) {\n        newRow = document.createElement('div');\n        newRow.className = 'field__row';\n        for (var j = 0; j < gameSettings.sizeX; j++) {\n          newElement = document.createElement('div');\n          newElement.className = 'cell empty custom-cell';\n          newElement.id = 'cell' + j + '_' + i;\n          newElement.style.maxWidth = size + 'vmin';\n          newRow.appendChild(newElement);\n        }\n        fragment.appendChild(newRow);\n      }\n    }\n    fieldElement.appendChild(fragment);\n\n    if (!isSettingsLoaded) {\n      \n      // Starting new game\n      gameSettings.isGameActive = true;\n      saveSettingsToLocal();\n      if (gameSettings.whoGoesFirst === 'random') gameSettings.isNextTurnByX = !!Math.round(Math.random());\n      else gameSettings.isNextTurnByX = (gameSettings.whoGoesFirst === 'x');\n      localStorage.removeItem('turns');\n    }\n    else {\n      \n      // Try to load turns if succeed in loading settings\n      loadedTurns = loadTurnsFromLocal();\n      showModalMessage('Your game settings and turns were loaded from the local storage');\n    }\n    \n    backFieldElement.innerHTML = (gameSettings.isNextTurnByX) ? 'x' : 'o';\n    myGameEngine.start(gameSettings, loadedTurns);\n    isJustLoaded = false;\n    isProcessing = false;\n    turnHandler();\n  }  \n\n  /*\n  *   Handler for checking whether size or win conditions were changed in the settings form\n  *\n  */\n  function checkIfSizeWinChange(e) {\n    if (gameSettings.sizeX !== Number(document.forms[0].elements.sizeX.value) ||\n      gameSettings.sizeY !== Number(document.forms[0].elements.sizeY.value) ||\n      gameSettings.winCondition !== Number(document.forms[0].elements.winCondition.value)) {\n        \n      // there was a change of size or win conditions --> disable Continue btn if enabled\n      if (isContinueEnabled) {\n        isContinueEnabled = false;\n        document.querySelector('#continueBtn').classList.add('btn-disabled');\n      }\n    }\n    else {\n\n      // no change of size or win conditions --> enable Continue btn if disabled\n      if (!isContinueEnabled) {\n        isContinueEnabled = true;\n        document.querySelector('#continueBtn').classList.remove('btn-disabled');\n      }\n    }\n  }\n\n  function showModalMessage(msg) {\n    var modal = document.getElementById('myModal');\n    var fnClose = function(e) {\n      modal.classList.add('modal__animation-hide');\n      modal.classList.remove('modal__animation-show');\n      window.removeEventListener('click', fnClose);\n      window.removeEventListener('keydown', fnClose);\n      setTimeout(function() {\n        modal.style.zIndex = -1;\n      }, 1500);\n    };\n    modal.style.zIndex = 2;\n    boardGameElement.classList.remove('boardgame__start-animation');\n    modal.querySelector('.modal__content__message').innerHTML = msg;\n    modal.classList.add('modal__animation-show');\n    modal.classList.remove('modal__animation-hide');\n    window.addEventListener('click', fnClose);\n    window.addEventListener('keydown', fnClose);\n  }\n\n  function submitOptionsHandler(e) {\n    e.preventDefault();\n    if (e.target.id === 'newGameBtn' ||\n      (e.target.id === 'continueBtn' && isContinueEnabled)) {\n      showOptions();\n      document.removeEventListener('click', restartClickHandler, false);\n      if (e.target.id === 'newGameBtn') {\n        setTimeout(function () {\n          restartGame(false);\n        }, 400);\n      }\n      else turnHandler();\n    }\n    return false;\n  }\n\n  function showOptions(e) {\n    boardGameElement.classList.remove('boardgame__start-animation');\n    if (boardElement.classList.contains('options__is-shown')) {\n      if (!e || e.target.className !== 'options-button') {\n        \n        // saving changes if it is not a click to 'Options' button:\n        gameSettings.isHumanX = document.forms[0].elements.isHumanX.value === 'true';\n        gameSettings.isHumanO = document.forms[0].elements.isHumanO.value === 'true';\n        gameSettings.whoGoesFirst = document.forms[0].elements.whoGoesFirst.value;\n        gameSettings.sizeX = Number(document.forms[0].elements.sizeX.value);\n        gameSettings.sizeY = Number(document.forms[0].elements.sizeY.value);\n        gameSettings.winCondition = Number(document.forms[0].elements.winCondition.value);\n        saveSettingsToLocal();\n      }\n      \n      //  Let's switch to \"Game board\" frame\n      boardElement.classList.add('options__animation-hide');\n      setTimeout(function() {\n        boardElement.classList.remove('options__is-shown');\n        boardElement.classList.remove('options__animation-hide');\n      }, 1400);\n    }\n    else {\n      \n      //  Let's switch to \"Options\" frame\n      document.forms[0].elements.isHumanX.value = gameSettings.isHumanX;\n      document.forms[0].elements.isHumanO.value = gameSettings.isHumanO;\n      document.forms[0].elements.whoGoesFirst.value = gameSettings.whoGoesFirst;\n      document.forms[0].elements.sizeX.value = gameSettings.sizeX;\n      document.forms[0].elements.sizeY.value = gameSettings.sizeY;\n      document.forms[0].elements.winCondition.value = gameSettings.winCondition;\n      isContinueEnabled = true;\n      document.querySelector('#continueBtn').classList.remove('btn-disabled');\n      boardElement.classList.add('options__animation-show');\n      setTimeout(function() {\n        boardElement.classList.add('options__is-shown');\n        boardElement.classList.remove('options__animation-show');\n      }, 1400);\n    }\n  }\n\n  function shakeEventDidOccur() {\n    var elems = document.querySelectorAll('.cell');\n    var delay;\n    if (!boardElement.classList.contains('options__is-shown')) {\n      for (var i = 0; i < elems.length; i++) {\n        if (!elems[i].classList.contains('mega-swing')) {\n          delay = Math.random() * 800;\n          (function(elem, delay) {\n            setTimeout(function() {\n              elem.classList.add('mega-swing');\n            }, delay);\n            setTimeout(function() {\n              elem.classList.remove('mega-swing');\n            }, delay + 2100);\n          })(elems[i], delay);\n        }\n      }\n    }\n    else if (!optionsFrameElement.classList.contains('mega-swing')) {\n      optionsFrameElement.classList.add('mega-swing');\n      setTimeout(function() {\n        optionsFrameElement.classList.remove('mega-swing');\n      }, 2100);\n    }\n  }\n\n  /* global localStorage */\n\n  function loadSettingsFromLocal() {\n    for (var key in gameSettings) {\n      if (localStorage[key] !== undefined) {\n        gameSettings[key] = (key === 'whoGoesFirst') ? localStorage[key] : JSON.parse(localStorage[key]);\n      }\n      else {\n        localStorage.clear();\n        return false;\n      }\n    }\n    return true;\n  }\n\n  function loadTurnsFromLocal() {\n    var turns = {};    \n    var loadTurns;\n    var loadTurn;\n    var elem;\n    var letter;\n    if (localStorage.turns) {\n      loadTurns = localStorage.turns.split('/');\n      if (loadTurns.length < 1) return false;\n      for (var i = loadTurns.length; i--;) {\n        loadTurn = loadTurns[i].split('_');\n        if (loadTurn.length !== 3) return false;\n        turns[loadTurn[0]] = {};\n        turns[loadTurn[0]].isByFirstPlayer = (loadTurn[1] === '1');\n        turns[loadTurn[0]].values = loadTurn[2].split(',');\n        turns[loadTurn[0]].values.forEach(function(item, i, arr) {\n          arr[i] = Number(item);\n        });\n        elem = document.querySelector('#cell' +\n          loadTurn[0].slice(0, loadTurn[0].indexOf(';')) + '_' + loadTurn[0].slice(loadTurn[0].indexOf(';') + 1));\n        letter = (loadTurn[1] === '0') ? 'o' : 'x';\n        elem.classList.add(letter + '-cell');\n        elem.innerHTML = letter;\n      }\n    }\n    return turns;\n  }\n\n  function saveSettingsToLocal() {\n    for (var key in gameSettings) {\n      localStorage[key] = gameSettings[key];\n    }\n  }\n\n  function checkIfTicTacToe() {\n    return gameSettings.sizeX === 3 && gameSettings.sizeY === 3 && gameSettings.winCondition === 3;\n  }\n\n  /*\n  *   This handler is fired when user clicks on the cell\n  *\n  */\n  function clickHandler(e) {\n    e.preventDefault();\n    var elem = document.elementFromPoint(e.clientX, e.clientY);\n    if (!isProcessing && gameSettings.isGameActive && elem.classList.contains('empty')) {\n      isProcessing = true;\n      if (checkIfDeviceTurn()) {\n        turnHandler();\n      }\n      else {\n        turnHandler(elem);\n      }\n    }\n  }\n\n  /*\n  *   This handler is fired by clickHandler or other methods \n  *   to calculate device's turn or to process user's one\n  *\n  */\n  function turnHandler(elem) {\n    if (elem === undefined && !checkIfDeviceTurn()) return;\n    var turnRes;\n    isProcessing = true;\n    if (elem === undefined) {\n      turnRes = myGameEngine.makeComputedTurn();\n      elem = document.querySelector('#cell' + turnRes.x + '_' + turnRes.y);\n    }\n    else turnRes = myGameEngine.makeTurn(Number(elem.id.slice(4, elem.id.indexOf('_'))),\n      Number(elem.id.slice(elem.id.indexOf('_') + 1)));\n    elem.classList.remove('empty');\n    if (gameSettings.isNextTurnByX) {\n      elem.classList.add('x-cell');\n      elem.innerHTML = 'x';\n    }\n    else {\n      elem.classList.add('o-cell');\n      elem.innerHTML = 'o';\n    }\n    elem.classList.add('start-swing');\n    setTimeout(function() {\n      elem.classList.remove('start-swing');\n    }, 2000);\n\n    if (turnRes.status === 'victory') {\n      for (var i = 0; i < turnRes.winArray.length; i++) {\n        document.querySelector('#cell' + turnRes.winArray[i].join('_')).classList.add('win-combo');\n      }\n    }\n    else if (turnRes.status === 'draw') {\n      backFieldElement.classList.add('field__background-fadeout');\n    }\n\n    if (turnRes.status === 'draw' || turnRes.status === 'victory') {\n      var elems = document.querySelectorAll('.cell:not(.win-combo)');\n      for (var i = 0; i < elems.length; i++) {\n        elems[i].classList.add('cell-fadeout');\n      }\n      gameSettings.isGameActive = false;\n      localStorage.removeItem('turns');\n      setTimeout(function() {\n          document.addEventListener('click', restartClickHandler, false);\n        },\n        1500);\n    }\n    else {\n      gameSettings.isNextTurnByX = !gameSettings.isNextTurnByX;\n      fadeBackground();\n\n      // Save turn to the localStorage:\n      if (!localStorage.turns) localStorage.turns = '';\n      else localStorage.turns += '/';\n      localStorage.turns = myGameEngine.turnsToString();\n      localStorage.isNextTurnByX = gameSettings.isNextTurnByX;\n    }\n\n    if (gameSettings.isGameActive && checkIfDeviceTurn()) {\n      setTimeout(turnHandler, Math.random() * 600 + 1500);\n    }\n    else {\n      isProcessing = false;\n    }\n  }\n\n  function checkIfDeviceTurn() {\n    return (gameSettings.isNextTurnByX && !gameSettings.isHumanX || \n      !gameSettings.isNextTurnByX && !gameSettings.isHumanO);\n  }\n\n  function restartGame(isWithAnimation) {\n    if (isWithAnimation) {\n      boardGameElement.classList.add('boardgame__start-animation');\n      setTimeout(function() {\n        boardGameElement.classList.remove('boardgame__start-animation');\n      }, 1200);\n    }\n    while (fieldElement.firstChild) {\n      fieldElement.removeChild(fieldElement.firstChild);\n    }\n    initGame();\n  }\n\n  function restartClickHandler(e) {\n    if (document.elementFromPoint(e.clientX, e.clientY).className === 'options-button' ||\n      boardElement.classList.contains('options__is-shown')) return;\n    document.removeEventListener('click', restartClickHandler, false);\n    restartGame(true);\n  }\n\n  function fadeBackground() {\n    backFieldElement.classList.add('field__background-fadeout');\n    setTimeout(function() {\n      backFieldElement.innerHTML = (gameSettings.isNextTurnByX) ? 'x' : 'o';\n      backFieldElement.classList.remove('field__background-fadeout');\n    }, 800);\n  }\n\n}();\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./xo-game-main.js\n ** module id = 0\n ** module chunks = 0\n **/","/*\n * Author: Alex Gibson\n * https://github.com/alexgibson/shake.js\n * License: MIT license\n */\n\n(function(global, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(function() {\n            return factory(global, global.document);\n        });\n    } else if (typeof module !== 'undefined' && module.exports) {\n        module.exports = factory(global, global.document);\n    } else {\n        global.Shake = factory(global, global.document);\n    }\n} (typeof window !== 'undefined' ? window : this, function (window, document) {\n\n    'use strict';\n\n    function Shake(options) {\n        //feature detect\n        this.hasDeviceMotion = 'ondevicemotion' in window;\n\n        this.options = {\n            threshold: 15, //default velocity threshold for shake to register\n            timeout: 1000 //default interval between events\n        };\n\n        if (typeof options === 'object') {\n            for (var i in options) {\n                if (options.hasOwnProperty(i)) {\n                    this.options[i] = options[i];\n                }\n            }\n        }\n\n        //use date to prevent multiple shakes firing\n        this.lastTime = new Date();\n\n        //accelerometer values\n        this.lastX = null;\n        this.lastY = null;\n        this.lastZ = null;\n\n        //create custom event\n        if (typeof document.CustomEvent === 'function') {\n            this.event = new document.CustomEvent('shake', {\n                bubbles: true,\n                cancelable: true\n            });\n        } else if (typeof document.createEvent === 'function') {\n            this.event = document.createEvent('Event');\n            this.event.initEvent('shake', true, true);\n        } else {\n            return false;\n        }\n    }\n\n    //reset timer values\n    Shake.prototype.reset = function () {\n        this.lastTime = new Date();\n        this.lastX = null;\n        this.lastY = null;\n        this.lastZ = null;\n    };\n\n    //start listening for devicemotion\n    Shake.prototype.start = function () {\n        this.reset();\n        if (this.hasDeviceMotion) {\n            window.addEventListener('devicemotion', this, false);\n        }\n    };\n\n    //stop listening for devicemotion\n    Shake.prototype.stop = function () {\n        if (this.hasDeviceMotion) {\n            window.removeEventListener('devicemotion', this, false);\n        }\n        this.reset();\n    };\n\n    //calculates if shake did occur\n    Shake.prototype.devicemotion = function (e) {\n        var current = e.accelerationIncludingGravity;\n        var currentTime;\n        var timeDifference;\n        var deltaX = 0;\n        var deltaY = 0;\n        var deltaZ = 0;\n\n        if ((this.lastX === null) && (this.lastY === null) && (this.lastZ === null)) {\n            this.lastX = current.x;\n            this.lastY = current.y;\n            this.lastZ = current.z;\n            return;\n        }\n\n        deltaX = Math.abs(this.lastX - current.x);\n        deltaY = Math.abs(this.lastY - current.y);\n        deltaZ = Math.abs(this.lastZ - current.z);\n\n        if (((deltaX > this.options.threshold) && (deltaY > this.options.threshold)) || ((deltaX > this.options.threshold) && (deltaZ > this.options.threshold)) || ((deltaY > this.options.threshold) && (deltaZ > this.options.threshold))) {\n            //calculate time in milliseconds since last shake registered\n            currentTime = new Date();\n            timeDifference = currentTime.getTime() - this.lastTime.getTime();\n\n            if (timeDifference > this.options.timeout) {\n                window.dispatchEvent(this.event);\n                this.lastTime = new Date();\n            }\n        }\n\n        this.lastX = current.x;\n        this.lastY = current.y;\n        this.lastZ = current.z;\n\n    };\n\n    //event handler\n    Shake.prototype.handleEvent = function (e) {\n        if (typeof (this[e.type]) === 'function') {\n            return this[e.type](e);\n        }\n    };\n\n    return Shake;\n}));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/shake.js/shake.js\n ** module id = 1\n ** module chunks = 0\n **/","/*\n *   Engine for processing m,n,k-games\n *\n *   In particular:\n *     - Tic-tac-toe is the 3,3,3-game \n *     - free-style Gomoku is the 15,15,5-game\n *\n *   More details about m,n,k - games:\n *   https://en.wikipedia.org/wiki/M,n,k-game\n */\n\nfunction XoGameEngine() {\n\n  //  Possible row orientations\n  var vectors = [\n    [-1, -1, 1, 1],\n    [0, -1, 0, 1],\n    [1, -1, -1, 1],\n    [-1, 0, 1, 0]\n  ];\n\n  //  Default game settings\n  var sizeX = 3;\n  var sizeY = 3;\n  var winCondition = 3;\n\n  var turns = {};\n  var currentPlayerIsFirst = true;\n  var winArray = [];\n  var isVictory = false;\n\n  //  Game init method: \n  this.start = function start(settings, loadedTurns) {\n    if (settings) {\n      sizeX = settings.sizeX;\n      sizeY = settings.sizeY;\n      winCondition = settings.winCondition;\n      currentPlayerIsFirst = settings.isNextTurnByX;\n    }\n    if (loadedTurns) {\n      turns = loadedTurns;\n    }\n    else {\n      turns = {};\n    }\n    winArray = [];\n    isVictory = false;\n  };\n\n  //  Method for packing turn information (to save to the local storage then)\n  this.turnsToString = function() {\n    var resArr = [];\n    var resArrTurn;\n    for (var key in turns) {\n      resArrTurn = [];\n      resArrTurn.push(key);\n      resArrTurn.push(Number(turns[key].isByFirstPlayer));\n      resArrTurn.push(turns[key].values.join(','));\n      resArr.push(resArrTurn.join('_'));\n    }\n    return resArr.join('/');\n  }\n\n  this.makeTurn = function makeTurn(x, y) {\n    var res = {\n      x: x,\n      y: y\n    };\n    if (x < 0 || y < 0 || x >= sizeX || y >= sizeY || (('' + x + ';' + y) in turns)) {\n      res.status = 'error';\n      return res;\n    }\n\n    // true means - let's also SET new calculated values to every proper cell\n    res.values = calculateValues(x, y, currentPlayerIsFirst, true);\n\n    if (Math.max.apply(null, res.values) >= winCondition) {\n      winArray.push([x, y]);\n      isVictory = true;\n    }\n\n    if (isVictory) {\n      res.status = 'victory';\n      res.winArray = winArray;\n      res.winnerIsFirst = currentPlayerIsFirst;\n      return res;\n    }\n\n    if (Object.keys(turns).length === sizeX * sizeY) {\n      res.status = 'draw';\n      return res;\n    }\n\n    currentPlayerIsFirst = !currentPlayerIsFirst;\n    res.status = 'ok';\n    return res;\n  };\n\n  this.makeComputedTurn = function() {\n    var bestTurn = {\n      x: Math.round(Math.random() * (sizeX - 1)),\n      y: Math.round(Math.random() * (sizeY - 1)),\n      score: 2\n    };\n    var candidates = {};\n    var newTurn;\n    var yourValues;\n    var sumWithPowFn;\n    for (var turn in turns) {\n      for (var i = 0; i < 4; i++) {\n        for (var j = 0; j < 4; j += 2) {\n          newTurn = {};\n          newTurn.x = vectors[i][j] + parseInt(turn.split(';')[0], 10);\n          newTurn.y = vectors[i][j + 1] + parseInt(turn.split(';')[1], 10);\n          if (newTurn.x < 0 || newTurn.y < 0 || newTurn.x >= sizeX ||\n            newTurn.y >= sizeY || (('' + newTurn.x + ';' + newTurn.y) in turns) ||\n            (('' + newTurn.x + ';' + newTurn.y) in candidates)) continue;\n\n          // false means 'only calculate without setting' \n          newTurn.values = calculateValues(newTurn.x, newTurn.y, currentPlayerIsFirst, false);\n          if (Math.max.apply(null, newTurn.values) >= winCondition) {\n            return this.makeTurn(newTurn.x, newTurn.y);\n          }\n\n          yourValues = calculateValues(newTurn.x, newTurn.y, !currentPlayerIsFirst, false);\n          if (Math.max.apply(null, yourValues) >= winCondition) {\n            newTurn.score = 10000;\n          }\n          else {\n            sumWithPowFn = function(sum, current) {\n              return sum + current * current;\n            };\n            newTurn.score = newTurn.values.reduce(sumWithPowFn, 0) +\n              yourValues.reduce(sumWithPowFn, 0);\n          }\n\n          candidates[('' + newTurn.x + ';' + newTurn.y)] = newTurn.score;\n          if (newTurn.score > bestTurn.score) bestTurn = newTurn;\n        }\n      }\n    }\n    return this.makeTurn(bestTurn.x, bestTurn.y);\n  };\n\n  // Private methods:\n\n  function getValue(x, y, directionId, isByFirstPlayer) {\n    if (isByFirstPlayer === undefined) isByFirstPlayer = currentPlayerIsFirst;\n    if (!(('' + x + ';' + y) in turns)) return 0;\n    var res = turns['' + x + ';' + y];\n    if (res.isByFirstPlayer === isByFirstPlayer) {\n      return Number(res.values[directionId]);\n    }\n    else return 0;\n  }\n\n  function calculateValues(x, y, isByFirstPlayer, isAlsoSet) {\n    var newValues = [];\n    for (var i = 0; i <= 3; i++) {\n      newValues[i] = 1 + getValue(x + vectors[i][0], y + vectors[i][1], i, isByFirstPlayer) +\n        getValue(x + vectors[i][2], y + vectors[i][3], i, isByFirstPlayer);\n      if (isAlsoSet) {\n        if (newValues[i] > 1) {\n          setValueByVector(x, y, newValues[i], i, vectors[i].slice(0, 2));\n          setValueByVector(x, y, newValues[i], i, vectors[i].slice(2));\n        }\n      }\n    }\n\n    if (isAlsoSet) {\n      turns[x + ';' + y] = {\n        isByFirstPlayer: currentPlayerIsFirst,\n        values: newValues,\n      };\n    }\n\n    return newValues;\n  }\n\n  function setValueByVector(x, y, value, directionId, vector) {\n    var myX = x + vector[0];\n    var myY = y + vector[1];\n    if (myX < 0 || myY < 0 || myX >= sizeX || myY >= sizeY ||\n      !(('' + myX + ';' + myY) in turns)) {\n         return false;\n    }\n    if (turns['' + myX + ';' + myY].isByFirstPlayer === currentPlayerIsFirst) {\n      turns['' + myX + ';' + myY].values[directionId] = value;\n      if (value >= winCondition) {\n        winArray.push([myX, myY]);\n      }\n      setValueByVector(myX, myY, value, directionId, vector);\n      return true;\n    }\n    return false;\n  }\n}\n\nmodule.exports = XoGameEngine;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./xo-game-engine.js\n ** module id = 2\n ** module chunks = 0\n **/","/*\n * classList.js: Cross-browser full element.classList implementation.\n * 2014-07-23\n *\n * By Eli Grey, http://eligrey.com\n * Public Domain.\n * NO WARRANTY EXPRESSED OR IMPLIED. USE AT YOUR OWN RISK.\n */\n\n/*global self, document, DOMException */\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/\n\n/* Copied from MDN:\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/classList\n */\n\nif (\"document\" in window.self) {\n\n  // Full polyfill for browsers with no classList support\n  // Including IE < Edge missing SVGElement.classList\n  if (!(\"classList\" in document.createElement(\"_\"))\n    || document.createElementNS && !(\"classList\" in document.createElementNS(\"http://www.w3.org/2000/svg\",\"g\"))) {\n\n  (function (view) {\n\n    \"use strict\";\n\n    if (!('Element' in view)) return;\n\n    var\n        classListProp = \"classList\"\n      , protoProp = \"prototype\"\n      , elemCtrProto = view.Element[protoProp]\n      , objCtr = Object\n      , strTrim = String[protoProp].trim || function () {\n        return this.replace(/^\\s+|\\s+$/g, \"\");\n      }\n      , arrIndexOf = Array[protoProp].indexOf || function (item) {\n        var\n            i = 0\n          , len = this.length\n        ;\n        for (; i < len; i++) {\n          if (i in this && this[i] === item) {\n            return i;\n          }\n        }\n        return -1;\n      }\n      // Vendors: please allow content code to instantiate DOMExceptions\n      , DOMEx = function (type, message) {\n        this.name = type;\n        this.code = DOMException[type];\n        this.message = message;\n      }\n      , checkTokenAndGetIndex = function (classList, token) {\n        if (token === \"\") {\n          throw new DOMEx(\n              \"SYNTAX_ERR\"\n            , \"An invalid or illegal string was specified\"\n          );\n        }\n        if (/\\s/.test(token)) {\n          throw new DOMEx(\n              \"INVALID_CHARACTER_ERR\"\n            , \"String contains an invalid character\"\n          );\n        }\n        return arrIndexOf.call(classList, token);\n      }\n      , ClassList = function (elem) {\n        var\n            trimmedClasses = strTrim.call(elem.getAttribute(\"class\") || \"\")\n          , classes = trimmedClasses ? trimmedClasses.split(/\\s+/) : []\n          , i = 0\n          , len = classes.length\n        ;\n        for (; i < len; i++) {\n          this.push(classes[i]);\n        }\n        this._updateClassName = function () {\n          elem.setAttribute(\"class\", this.toString());\n        };\n      }\n      , classListProto = ClassList[protoProp] = []\n      , classListGetter = function () {\n        return new ClassList(this);\n      }\n    ;\n    // Most DOMException implementations don't allow calling DOMException's toString()\n    // on non-DOMExceptions. Error's toString() is sufficient here.\n    DOMEx[protoProp] = Error[protoProp];\n    classListProto.item = function (i) {\n      return this[i] || null;\n    };\n    classListProto.contains = function (token) {\n      token += \"\";\n      return checkTokenAndGetIndex(this, token) !== -1;\n    };\n    classListProto.add = function () {\n      var\n          tokens = arguments\n        , i = 0\n        , l = tokens.length\n        , token\n        , updated = false\n      ;\n      do {\n        token = tokens[i] + \"\";\n        if (checkTokenAndGetIndex(this, token) === -1) {\n          this.push(token);\n          updated = true;\n        }\n      }\n      while (++i < l);\n\n      if (updated) {\n        this._updateClassName();\n      }\n    };\n    classListProto.remove = function () {\n      var\n          tokens = arguments\n        , i = 0\n        , l = tokens.length\n        , token\n        , updated = false\n        , index\n      ;\n      do {\n        token = tokens[i] + \"\";\n        index = checkTokenAndGetIndex(this, token);\n        while (index !== -1) {\n          this.splice(index, 1);\n          updated = true;\n          index = checkTokenAndGetIndex(this, token);\n        }\n      }\n      while (++i < l);\n\n      if (updated) {\n        this._updateClassName();\n      }\n    };\n    classListProto.toggle = function (token, force) {\n      token += \"\";\n\n      var\n          result = this.contains(token)\n        , method = result ?\n          force !== true && \"remove\"\n        :\n          force !== false && \"add\"\n      ;\n\n      if (method) {\n        this[method](token);\n      }\n\n      if (force === true || force === false) {\n        return force;\n      } else {\n        return !result;\n      }\n    };\n    classListProto.toString = function () {\n      return this.join(\" \");\n    };\n\n    if (objCtr.defineProperty) {\n      var classListPropDesc = {\n          get: classListGetter\n        , enumerable: true\n        , configurable: true\n      };\n      try {\n        objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n      } catch (ex) { // IE 8 doesn't support enumerable:true\n        if (ex.number === -0x7FF5EC54) {\n          classListPropDesc.enumerable = false;\n          objCtr.defineProperty(elemCtrProto, classListProp, classListPropDesc);\n        }\n      }\n    } else if (objCtr[protoProp].__defineGetter__) {\n      elemCtrProto.__defineGetter__(classListProp, classListGetter);\n    }\n\n    }(window.self));\n\n    } else {\n    // There is full or partial native classList support, so just check if we need\n    // to normalize the add/remove and toggle APIs.\n\n    (function () {\n      \"use strict\";\n\n      var testElement = document.createElement(\"_\");\n\n      testElement.classList.add(\"c1\", \"c2\");\n\n      // Polyfill for IE 10/11 and Firefox <26, where classList.add and\n      // classList.remove exist but support only one argument at a time.\n      if (!testElement.classList.contains(\"c2\")) {\n        var createMethod = function(method) {\n          var original = DOMTokenList.prototype[method];\n\n          DOMTokenList.prototype[method] = function(token) {\n            var i, len = arguments.length;\n\n            for (i = 0; i < len; i++) {\n              token = arguments[i];\n              original.call(this, token);\n            }\n          };\n        };\n        createMethod('add');\n        createMethod('remove');\n      }\n\n      testElement.classList.toggle(\"c3\", false);\n\n      // Polyfill for IE 10 and Firefox <24, where classList.toggle does not\n      // support the second argument.\n      if (testElement.classList.contains(\"c3\")) {\n        var _toggle = DOMTokenList.prototype.toggle;\n\n        DOMTokenList.prototype.toggle = function(token, force) {\n          if (1 in arguments && !this.contains(token) === !force) {\n            return force;\n          } else {\n            return _toggle.call(this, token);\n          }\n        };\n\n      }\n\n      testElement = null;\n    }());\n  }\n}\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/classlist-polyfill/src/index.js\n ** module id = 3\n ** module chunks = 0\n **/"],"sourceRoot":""}