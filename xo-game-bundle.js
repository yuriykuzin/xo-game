!function(e){function t(i){if(n[i])return n[i].exports;var s=n[i]={exports:{},id:i,loaded:!1};return e[i].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){!function(){"use strict";function e(){var e,t,n,s,o=document.createDocumentFragment(),a=!1;if(k&&localStorage.length>=8&&(a=r()),u()){T.textContent="";for(var d=0;d<E.sizeY;d++){t=document.createElement("div"),t.className="field__row";for(var h=0;h<E.sizeX;h++)e=document.createElement("div"),e.className="cell empty",e.id="cell"+h+"_"+d,t.appendChild(e);o.appendChild(t)}}else{s=90/Math.max(E.sizeX,E.sizeY)-140/Math.min(document.body.clientWidth,document.body.clientHeight),T.textContent=".cell {width: "+s+"vmin; height: "+s+"vmin; font-size: "+s+"vmin;}";for(var d=0;d<E.sizeY;d++){t=document.createElement("div"),t.className="field__row";for(var h=0;h<E.sizeX;h++)e=document.createElement("div"),e.className="cell empty custom-cell",e.id="cell"+h+"_"+d,e.style.maxWidth=s+"vmin",t.appendChild(e);o.appendChild(t)}}w.appendChild(o),a?(n=l(),i("Your game settings and turns were loaded from the local storage")):(E.isGameActive=!0,c(),"random"===E.whoGoesFirst?E.isNextTurnByX=!!Math.round(Math.random()):E.isNextTurnByX="x"===E.whoGoesFirst,localStorage.removeItem("turns")),p.innerHTML=E.isNextTurnByX?"x":"o",b.start(E,n),k=!1,B=!1,m()}function t(e){E.sizeX!==+document.forms[0].elements.sizeX.value||E.sizeY!==+document.forms[0].elements.sizeY.value||E.winCondition!==+document.forms[0].elements.winCondition.value?z&&(z=!1,document.querySelector("#continueBtn").classList.add("btn-disabled")):z||(z=!0,document.querySelector("#continueBtn").classList.remove("btn-disabled"))}function i(e){var t=document.getElementById("myModal"),n=function(e){t.classList.add("modal__animation-hide"),t.classList.remove("modal__animation-show"),window.removeEventListener("click",n),window.removeEventListener("keydown",n),setTimeout(function(){t.style.zIndex=-1},1500)};t.style.zIndex=2,g.classList.remove("boardgame__start-animation"),t.querySelector(".modal__content__message").innerHTML=e,t.classList.add("modal__animation-show"),t.classList.remove("modal__animation-hide"),window.addEventListener("click",n),window.addEventListener("keydown",n)}function s(e){return e.preventDefault(),("newGameBtn"===e.target.id||"continueBtn"===e.target.id&&z)&&(o(),document.removeEventListener("click",f,!1),"newGameBtn"===e.target.id?setTimeout(function(){v(!1)},400):m()),!1}function o(e){g.classList.remove("boardgame__start-animation"),_.classList.contains("options__is-shown")?(e&&"options-button"===e.target.className||(E.isHumanX="true"===document.forms[0].elements.isHumanX.value,E.isHumanO="true"===document.forms[0].elements.isHumanO.value,E.whoGoesFirst=document.forms[0].elements.whoGoesFirst.value,E.sizeX=+document.forms[0].elements.sizeX.value,E.sizeY=+document.forms[0].elements.sizeY.value,E.winCondition=+document.forms[0].elements.winCondition.value,c()),_.classList.add("options__animation-hide"),setTimeout(function(){_.classList.remove("options__is-shown"),_.classList.remove("options__animation-hide")},1400)):(document.forms[0].elements.isHumanX.value=E.isHumanX,document.forms[0].elements.isHumanO.value=E.isHumanO,document.forms[0].elements.whoGoesFirst.value=E.whoGoesFirst,document.forms[0].elements.sizeX.value=E.sizeX,document.forms[0].elements.sizeY.value=E.sizeY,document.forms[0].elements.winCondition.value=E.winCondition,z=!0,document.querySelector("#continueBtn").classList.remove("btn-disabled"),_.classList.add("options__animation-show"),setTimeout(function(){_.classList.add("options__is-shown"),_.classList.remove("options__animation-show")},1400))}function a(){var e,t=document.querySelectorAll(".cell");if(_.classList.contains("options__is-shown"))x.classList.contains("mega-swing")||(x.classList.add("mega-swing"),setTimeout(function(){x.classList.remove("mega-swing")},2100));else for(var n=0;n<t.length;n++)t[n].classList.contains("mega-swing")||(e=800*Math.random(),function(e,t){setTimeout(function(){e.classList.add("mega-swing")},t),setTimeout(function(){e.classList.remove("mega-swing")},t+2100)}(t[n],e))}function r(){for(var e in E){if(void 0===localStorage[e])return localStorage.clear(),!1;E[e]="whoGoesFirst"===e?localStorage[e]:JSON.parse(localStorage[e])}return!0}function l(){var e,t,n,i,s={};if(localStorage.turns){if(e=localStorage.turns.split("/"),e.length<1)return!1;for(var o=e.length;o--;){if(t=e[o].split("_"),3!==t.length)return!1;s[t[0]]={},s[t[0]].isByFirstPlayer="1"===t[1],s[t[0]].values=t[2].split(","),s[t[0]].values.forEach(function(e,t,n){n[t]=+e}),n=document.querySelector("#cell"+t[0].slice(0,t[0].indexOf(";"))+"_"+t[0].slice(t[0].indexOf(";")+1)),i="0"===t[1]?"o":"x",n.classList.add(i+"-cell"),n.innerHTML=i}}return s}function c(){for(var e in E)localStorage[e]=E[e]}function u(){return 3===E.sizeX&&3===E.sizeY&&3===E.winCondition}function d(e){e.preventDefault();var t=document.elementFromPoint(e.clientX,e.clientY);!B&&E.isGameActive&&t.classList.contains("empty")&&(B=!0,h()?m():m(t))}function m(e){if(void 0!==e||h()){var t;if(B=!0,void 0===e?(t=b.makeComputedTurn(),e=document.querySelector("#cell"+t.x+"_"+t.y)):t=b.makeTurn(+e.id.slice(4,e.id.indexOf("_")),+e.id.slice(e.id.indexOf("_")+1)),e.classList.remove("empty"),E.isNextTurnByX?(e.classList.add("x-cell"),e.innerHTML="x"):(e.classList.add("o-cell"),e.innerHTML="o"),e.classList.add("start-swing"),setTimeout(function(){e.classList.remove("start-swing")},2e3),"victory"===t.status)for(var n=0;n<t.winArray.length;n++)document.querySelector("#cell"+t.winArray[n].join("_")).classList.add("win-combo");else"draw"===t.status&&p.classList.add("field__background-fadeout");if("draw"===t.status||"victory"===t.status){for(var i=document.querySelectorAll(".cell:not(.win-combo)"),n=0;n<i.length;n++)i[n].classList.add("cell-fadeout");E.isGameActive=!1,localStorage.removeItem("turns"),setTimeout(function(){document.addEventListener("click",f,!1)},1500)}else E.isNextTurnByX=!E.isNextTurnByX,y(),localStorage.turns?localStorage.turns+="/":localStorage.turns="",localStorage.turns=b.turnsToString(),localStorage.isNextTurnByX=E.isNextTurnByX;E.isGameActive&&h()?setTimeout(m,600*Math.random()+1500):B=!1}}function h(){return E.isNextTurnByX&&!E.isHumanX||!E.isNextTurnByX&&!E.isHumanO}function v(t){for(t&&(g.classList.add("boardgame__start-animation"),setTimeout(function(){g.classList.remove("boardgame__start-animation")},1200));w.firstChild;)w.removeChild(w.firstChild);e()}function f(e){"options-button"===document.elementFromPoint(e.clientX,e.clientY).className||_.classList.contains("options__is-shown")||(document.removeEventListener("click",f,!1),v(!0))}function y(){p.classList.add("field__background-fadeout"),setTimeout(function(){p.innerHTML=E.isNextTurnByX?"x":"o",p.classList.remove("field__background-fadeout")},800)}var p,w,g,_,L,x,T,X=n(1),S=n(2),b=new S,E={isHumanX:!1,isHumanO:!0,isGameActive:!1,isNextTurnByX:!0,whoGoesFirst:"x",sizeX:3,sizeY:3,winCondition:3},z=!0,k=!0,B=!1;window.onload=function(){T=document.createElement("style"),T.id="s_myCellStyle",document.head.appendChild(T),T=document.getElementById("s_myCellStyle"),g=document.querySelector(".board__game"),w=document.querySelector(".field"),_=document.querySelector(".board"),x=document.querySelector(".options-frame"),p=document.querySelector(".field__background"),L=document.querySelector(".options-button"),setTimeout(function(){g.classList.remove("boardgame__start-animation")},1200),w.addEventListener("click",d,!1),x.querySelector(".options-form").addEventListener("click",s,!1),x.querySelector(".options-form").addEventListener("change",t,!1),L.addEventListener("click",o,!1),w.addEventListener("click",d,!1);var n=new X({threshold:3,timeout:1e3});n.start(),window.addEventListener("shake",a,!1),e()}}()},function(e,t,n){var i;!function(s,o){i=function(){return o(s,s.document)}.call(t,n,t,e),!(void 0!==i&&(e.exports=i))}("undefined"!=typeof window?window:this,function(e,t){"use strict";function n(n){if(this.hasDeviceMotion="ondevicemotion"in e,this.options={threshold:15,timeout:1e3},"object"==typeof n)for(var i in n)n.hasOwnProperty(i)&&(this.options[i]=n[i]);if(this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null,"function"==typeof t.CustomEvent)this.event=new t.CustomEvent("shake",{bubbles:!0,cancelable:!0});else{if("function"!=typeof t.createEvent)return!1;this.event=t.createEvent("Event"),this.event.initEvent("shake",!0,!0)}}return n.prototype.reset=function(){this.lastTime=new Date,this.lastX=null,this.lastY=null,this.lastZ=null},n.prototype.start=function(){this.reset(),this.hasDeviceMotion&&e.addEventListener("devicemotion",this,!1)},n.prototype.stop=function(){this.hasDeviceMotion&&e.removeEventListener("devicemotion",this,!1),this.reset()},n.prototype.devicemotion=function(t){var n,i,s=t.accelerationIncludingGravity,o=0,a=0,r=0;return null===this.lastX&&null===this.lastY&&null===this.lastZ?(this.lastX=s.x,this.lastY=s.y,void(this.lastZ=s.z)):(o=Math.abs(this.lastX-s.x),a=Math.abs(this.lastY-s.y),r=Math.abs(this.lastZ-s.z),(o>this.options.threshold&&a>this.options.threshold||o>this.options.threshold&&r>this.options.threshold||a>this.options.threshold&&r>this.options.threshold)&&(n=new Date,i=n.getTime()-this.lastTime.getTime(),i>this.options.timeout&&(e.dispatchEvent(this.event),this.lastTime=new Date)),this.lastX=s.x,this.lastY=s.y,void(this.lastZ=s.z))},n.prototype.handleEvent=function(e){if("function"==typeof this[e.type])return this[e.type](e)},n})},function(e,t){function n(){function e(e,t,n,i){if(void 0===i&&(i=l),!(""+e+";"+t in r))return 0;var s=r[""+e+";"+t];return s.isByFirstPlayer===i?+s.values[n]:0}function t(t,s,o,a){for(var c=[],u=0;u<=3;u++)c[u]=1+e(t+i[u][0],s+i[u][1],u,o)+e(t+i[u][2],s+i[u][3],u,o),a&&c[u]>1&&(n(t,s,c[u],u,i[u].slice(0,2)),n(t,s,c[u],u,i[u].slice(2)));return a&&(r[t+";"+s]={isByFirstPlayer:l,values:c}),c}function n(e,t,i,u,d){var m=e+d[0],h=t+d[1];return!(m<0||h<0||m>=s||h>=o)&&""+m+";"+h in r&&(r[""+m+";"+h].isByFirstPlayer===l&&(r[""+m+";"+h].values[u]=i,i>=a&&c.push([m,h]),n(m,h,i,u,d),!0))}var i=[[-1,-1,1,1],[0,-1,0,1],[1,-1,-1,1],[-1,0,1,0]],s=3,o=3,a=3,r={},l=!0,c=[],u=!1;this.start=function(e,t){e&&(s=e.sizeX,o=e.sizeY,a=e.winCondition,l=e.isNextTurnByX),r=t?t:{},c=[],u=!1},this.turnsToString=function(){var e,t=[];for(var n in r)e=[],e.push(n),e.push(+r[n].isByFirstPlayer),e.push(r[n].values.join(",")),t.push(e.join("_"));return t.join("/")},this.makeTurn=function(e,n){var i={x:e,y:n};return e<0||n<0||e>=s||n>=o||""+e+";"+n in r?(i.status="error",i):(i.values=t(e,n,l,!0),Math.max.apply(null,i.values)>=a&&(c.push([e,n]),u=!0),u?(i.status="victory",i.winArray=c,i.winnerIsFirst=l,i):Object.keys(r).length===s*o?(i.status="draw",i):(l=!l,i.status="ok",i))},this.makeComputedTurn=function(){var e,n,c,u={x:Math.round(Math.random()*(s-1)),y:Math.round(Math.random()*(o-1)),score:2},d={};for(var m in r)for(var h=0;h<4;h++)for(var v=0;v<4;v+=2)if(e={},e.x=i[h][v]+parseInt(m.split(";")[0],10),e.y=i[h][v+1]+parseInt(m.split(";")[1],10),!(e.x<0||e.y<0||e.x>=s||e.y>=o||""+e.x+";"+e.y in r||""+e.x+";"+e.y in d)){if(e.values=t(e.x,e.y,l,!1),Math.max.apply(null,e.values)>=a)return this.makeTurn(e.x,e.y);n=t(e.x,e.y,!l,!1),Math.max.apply(null,n)>=a?e.score=1e4:(c=function(e,t){return e+t*t},e.score=e.values.reduce(c,0)+n.reduce(c,0)),d[""+e.x+";"+e.y]=e.score,e.score>u.score&&(u=e)}return this.makeTurn(u.x,u.y)}}e.exports=n}]);